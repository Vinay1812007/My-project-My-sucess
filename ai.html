<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chat AI</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="/style.css">
</head>

<body class="glass">

<header class="header">ðŸ¤– Chat AI</header>

<div id="chat" class="chat"></div>

<div class="typing" id="typing">AI is typingâ€¦</div>

<div class="input-bar">
  <input id="msg" placeholder="Ask anythingâ€¦" />
  <button onclick="send()">Send</button>
</div>

<script>
const chat = document.getElementById("chat");
const typing = document.getElementById("typing");
const input = document.getElementById("msg");

let history = JSON.parse(localStorage.getItem("chat_history") || "[]");
history.forEach(addMsg);

function addMsg({role,text}) {
  const div = document.createElement("div");
  div.className = "bubble " + role;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

async function send() {
  const text = input.value.trim();
  if (!text) return;

  addMsg({role:"user",text});
  history.push({role:"user",text});
  input.value="";
  typing.style.display="block";

  // free public AI endpoint (no key)
  const res = await fetch("https://api.allorigins.win/raw?url=" +
    encodeURIComponent(
      "https://api.affiliateplus.xyz/api/chatbot?message=" +
      encodeURIComponent(text) +
      "&name=Vinay&owner=Vinay&user=web"
    )
  );

  const data = await res.json();
  typing.style.display="none";

  addMsg({role:"ai",text:data.message});
  history.push({role:"ai",text:data.message});

  localStorage.setItem("chat_history", JSON.stringify(history));
}
</script>

<script src="/script.js"></script>
</body>
</html>
