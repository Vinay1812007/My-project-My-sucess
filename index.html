<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Vinay AI</title>

<style>
/* ---------- RESET ---------- */
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; font-family: -apple-system, BlinkMacSystemFont, sans-serif; }

/* ---------- BACKGROUND ---------- */
body {
  background: radial-gradient(circle at top, #1e2a4a, #060b18);
  color: white;
  overflow: hidden;
}

/* ---------- APP LAYOUT ---------- */
.app {
  height: 100%;
  display: flex;
  flex-direction: column;
}

/* ---------- HEADER ---------- */
header {
  padding: 14px;
  text-align: center;
  font-weight: 600;
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

/* ---------- CHAT AREA ---------- */
#chat {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* ---------- BUBBLES ---------- */
.user {
  align-self: flex-end;
  background: linear-gradient(135deg, #2563eb, #1d4ed8);
  padding: 12px 16px;
  border-radius: 18px 18px 4px 18px;
  max-width: 80%;
}

.bot {
  align-self: flex-start;
  background: rgba(255,255,255,0.1);
  padding: 12px 16px;
  border-radius: 18px 18px 18px 4px;
  max-width: 80%;
}

/* ---------- INPUT BAR (NO BLUR = FIXED) ---------- */
.input-bar {
  display: flex;
  gap: 8px;
  padding: 10px;
  background: #050a18;
  border-top: 1px solid rgba(255,255,255,0.1);
}

select, button {
  background: rgba(255,255,255,0.12);
  color: white;
  border: none;
  border-radius: 12px;
  padding: 10px;
}

input {
  flex: 1;
  padding: 12px;
  border-radius: 14px;
  border: none;
  background: rgba(255,255,255,0.15);
  color: white;
  font-size: 16px;
  outline: none;

  /* CRITICAL FIX */
  transform: translateZ(0);
  -webkit-appearance: none;
}

button { cursor: pointer; }

.tools {
  display: flex;
  gap: 6px;
}

/* ---------- MOBILE ---------- */
@media (max-width: 600px) {
  select { display: none; }
}
</style>
</head>

<body>
<div class="app">

<header>Vinay AI Assistant âœ¨</header>

<div id="chat"></div>

<div class="input-bar">
  <select id="model">
    <option value="groq">Groq</option>
    <option value="gemini">Gemini</option>
    <option value="image">Image</option>
    <option value="video">Video</option>
  </select>

  <select id="persona">
    <option value="">Default</option>
    <option value="coder">Coder</option>
    <option value="teacher">Teacher</option>
  </select>

  <input id="input" placeholder="Type here..." />

  <div class="tools">
    <button onclick="exportChat()">ðŸ“¤</button>
    <button onclick="send()">âž¤</button>
  </div>
</div>

</div>

<script>
/* ---------- MEMORY ---------- */
let memory = JSON.parse(localStorage.getItem("memory") || "[]");

/* ---------- ELEMENTS ---------- */
const chat = document.getElementById("chat");
const input = document.getElementById("input");
const model = document.getElementById("model");
const persona = document.getElementById("persona");

/* ---------- RENDER ---------- */
function addBubble(text, cls) {
  const div = document.createElement("div");
  div.className = cls;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

/* ---------- FAKE AI (SAFE DEMO) ---------- */
function aiReply(text) {
  return new Promise(r => {
    setTimeout(() => {
      r("âœ… Working response from " + model.value + " model.\nYou said: " + text);
    }, 700);
  });
}

/* ---------- SEND ---------- */
async function send() {
  const text = input.value.trim();
  if (!text) return;

  addBubble(text, "user");
  memory.push(text);
  localStorage.setItem("memory", JSON.stringify(memory));
  input.value = "";

  const bot = document.createElement("div");
  bot.className = "bot";
  bot.textContent = "Typing...";
  chat.appendChild(bot);
  chat.scrollTop = chat.scrollHeight;

  const personaText = {
    coder: "As a senior developer: ",
    teacher: "As a teacher: "
  }[persona.value] || "";

  const reply = await aiReply(personaText + text);

  bot.textContent = reply;
  speak(reply);
}

/* ---------- ENTER KEY ---------- */
input.addEventListener("keydown", e => {
  if (e.key === "Enter") send();
});

/* ---------- VOICE ---------- */
function speak(text) {
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "en-US";
  speechSynthesis.speak(u);
}

/* ---------- EXPORT ---------- */
function exportChat() {
  const text = [...chat.children].map(d => d.innerText).join("\n\n");
  const blob = new Blob([text], { type: "text/plain" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "chat.txt";
  a.click();
}
</script>
</body>
</html>
