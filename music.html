<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Music â€¢ Sirimilla Vinay</title>

  <!-- SEO -->
  <meta name="description" content="Stream and discover music with a fast, beautiful Spotify-style player. Free and legal previews." />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://sirimillavinay.online/music" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="/favicon.png" />
  <link rel="stylesheet" href="/style.css" />
</head>

<body>
<main role="main" aria-label="Music Player" style="padding-bottom:120px">

  <!-- HEADER -->
  <header class="glass" style="margin:16px; padding:20px">
    <h1>ðŸŽµ Music</h1>
    <input
      id="search"
      type="search"
      placeholder="Search songs, artists, albumsâ€¦"
      aria-label="Search music"
      style="width:100%; margin-top:12px; padding:12px; border-radius:12px; border:none"
    />
  </header>

  <!-- RESULTS -->
  <section id="results" style="padding:16px; display:grid; gap:12px"></section>

</main>

<!-- MINI PLAYER -->
<footer class="glass" style="
  position:fixed;
  bottom:70px;
  left:16px;
  right:16px;
  padding:14px;
  display:flex;
  align-items:center;
  gap:12px;
">
  <img id="cover" src="" alt="" width="48" height="48" style="border-radius:8px; display:none" />
  <div style="flex:1">
    <strong id="title">Not Playing</strong>
    <div class="muted" id="artist"></div>
  </div>
  <button class="button" id="play">â–¶</button>
</footer>

<!-- NAV -->
<nav class="navbar">
  <a href="/home">Home</a>
  <a href="/music" class="active">Music</a>
  <a href="/chat.ai">AI</a>
  <a href="/videodownloder">Video</a>
  <a href="/chat">Chat</a>
</nav>

<script src="/script.js" defer></script>

<script>
(() => {
  "use strict";

  const results = document.getElementById("results");
  const search = document.getElementById("search");
  const audio = new Audio();
  let current = null;

  async function searchMusic(q) {
    results.innerHTML = "<p class='muted'>Searchingâ€¦</p>";
    const res = await fetch(`/api/music-proxy?q=${encodeURIComponent(q)}`);
    const data = await res.json();

    results.innerHTML = "";
    data.results.forEach(track => {
      if (!track.previewUrl) return;

      const card = document.createElement("div");
      card.className = "glass";
      card.style.padding = "14px";
      card.innerHTML = `
        <strong>${track.trackName}</strong>
        <div class="muted">${track.artistName}</div>
      `;
      card.onclick = () => play(track);
      results.appendChild(card);
    });
  }

  function play(track) {
    current = track;
    audio.src = track.previewUrl;
    audio.play();

    document.getElementById("title").textContent = track.trackName;
    document.getElementById("artist").textContent = track.artistName;

    const img = document.getElementById("cover");
    img.src = track.artworkUrl100;
    img.style.display = "block";
  }

  document.getElementById("play").onclick = () => {
    if (audio.paused) audio.play();
    else audio.pause();
  };

  search.addEventListener("input", e => {
    if (e.target.value.length > 2) {
      searchMusic(e.target.value);
    }
  });

  // Keyboard shortcuts
  document.addEventListener("keydown", e => {
    if (e.code === "Space" && current) {
      e.preventDefault();
      audio.paused ? audio.play() : audio.pause();
    }
  });

})();
</script>

</body>
</html>
